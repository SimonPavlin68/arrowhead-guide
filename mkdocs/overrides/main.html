{% extends "base.html" %}

{% block header %}
  {{ super() }}

  <script>
    document.addEventListener("DOMContentLoaded", function() {
        let user = localStorage.getItem("arrowheadUser");
        if (!user) return;

        function insertUserChip() {
            // Poišči notranji header container (ta ima vedno flex layout)
            const headerInner = document.querySelector(".md-header__inner");

            if (!headerInner) {
                setTimeout(insertUserChip, 100);
                return;
            }

            // Če je že prisoten, ne podvajamo
            if (document.getElementById("userChip")) return;

            const chip = document.createElement("div");
            chip.id = "userChip";
            chip.textContent = user;

	    // Dodamo gumb X
	    const logout = document.createElement("span");
	    logout.textContent = "×";
	    logout.style.marginLeft = "8px";
	    logout.style.cursor = "pointer";
	    logout.style.fontWeight = "bold";

	    // klik = izbriši user + reload
	    logout.onclick = () => {
	        localStorage.removeItem("arrowheadUser");
	        location.reload();
	    };
	    
	    chip.appendChild(logout);

            // Chip styling
            chip.style.background = "rgba(255,255,255,0.15)";
            chip.style.padding = "4px 14px";
            chip.style.borderRadius = "20px";
            chip.style.fontSize = "0.8rem";
            chip.style.color = "white";
            chip.style.fontWeight = "500";
            chip.style.display = "flex";
            chip.style.alignItems = "center";
            chip.style.height = "32px";
            chip.style.marginLeft = "20px";
            chip.style.whiteSpace = "nowrap";

            // POTISNE GA ČISTO DESNO
            chip.style.marginLeft = "auto";

            headerInner.appendChild(chip);
        }

        insertUserChip();
    });
  </script>
{% endblock %}

