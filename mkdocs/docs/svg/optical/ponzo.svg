<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink="http://www.w3.org/1999/xlink" version='1.1' width='800' height='600' viewBox="0 0 800 600"
	onload="InitDraw(evt)"
	onmousedown="Grab(evt)"
	onmousemove="Drag(evt)"
	onmouseup="Drop(evt)"
	onclick="OnClick()">
<desc>Author: Simon Pavlin, 2025</desc>
	
	<style>
      .draggable {
        cursor: move;
    }
    </style>
	<defs>
		<g id="target" stroke-width="0.5" fill="none" stroke="black">
			<circle x="0" y="0" r="50" fill="white"  />
			<circle x="0" y="0" r="45" />
			<circle x="0" y="0" r="40" fill="black" />
			<circle x="0" y="0" r="35" stroke="white" />
			<circle x="0" y="0" r="30" fill="blue" />
			<circle x="0" y="0" r="25" />
			<circle x="0" y="0" r="20" fill="red" />
			<circle x="0" y="0" r="15" />
			<circle x="0" y="0" r="10" fill="yellow" />
			<circle x="0" y="0" r="5" />
			<line x1="-2" y1="0" x2="2" y2="0" />
			<line x1="0" y1="-2" x2="0" y2="2" />
		</g>
	</defs>
	<rect id="BackDrop" x="0" y="0" width="800" height="600" pointer-events="all" fill="#bfbfbf" />
	
	<g fill="black" stroke="black" stroke-width="4" stroke-linecap="round">
		// pokončne	glavne	
		<line x1="2" y1="30" x2="2" y2="570" />
		<line x1="100" y1="15" x2="100" y2="585" />
		<line x1="600" y1="205" x2="600" y2="395" />
		<line x1="798" y1="195" x2="798" y2="405" />
		// vodoravne levo
		<line x1="2" y1="30" x2="100" y2="15" />
		<line x1="2" y1="210" x2="100" y2="205" />
		<line x1="2" y1="390" x2="100" y2="395" />
		<line x1="2" y1="570" x2="100" y2="585" />
		// vodoravno sredina
		<line x1="100" y1="15" x2="600" y2="205" />
		<line x1="100" y1="205" x2="600" y2="268.3" />
		<line x1="100" y1="395" x2="600" y2="331.6" />
		<line x1="100" y1="585" x2="600" y2="395" />
		// vodoravno desno
		<line x1="600" y1="205" x2="798" y2="195" />
		<line x1="600" y1="268.3" x2="798" y2="265" />
		<line x1="600" y1="331.6" x2="798" y2="335" />
		<line x1="600" y1="395" x2="798" y2="405" />
		// pokončne desno
		<line x1="664" y1="202" x2="664" y2="398"/>
		<line x1="731" y1="199" x2="731" y2="401" />
		// pokončne levo
		<line x1="250" y1="72" x2="250" y2="528" />
		<line x1="375" y1="120" x2="375" y2="480" />
		<line x1="470" y1="156" x2="470" y2="444" />
		<line x1="550" y1="187" x2="550" y2="413" />
		// zelene
		<line class="hide draggable" id="Line1" x1="100" y1="210" x2="100" y2="390" stroke="red" stroke-width="6" opacity="0" stroke-linecap="round" />
		<line class="hide draggable" id="Line2" x1="600" y1="210" x2="600" y2="390" stroke="red" stroke-width="6" opacity="0" stroke-linecap="round"/>

		<use xlink:href="#target" id="Target1" class="draggable" transform="translate(731,335)" />

	</g>

<script><![CDATA[

var svg = document.getElementsByTagName('svg')[0];
var svgns = "http://www.w3.org/2000/svg";

var SVGDocument = null;
var SVGRoot = null;

var TrueCoords = null;
var GrabPoint = null;
var BackDrop = null;
var DragTarget = null;

var hide = false;

function OnClick() {
	var elements = document.getElementsByClassName('hide');
	for(i=0; i<elements.length; i++) {
		if(hide) {
			elements[i].setAttribute('opacity', 0);
		} else {
			elements[i].setAttribute('opacity', 1);
		}
	}
	hide = !hide;
}

      function InitDraw(evt) {
         SVGDocument = evt.target.ownerDocument;
         SVGRoot = SVGDocument.documentElement;
         TrueCoords = SVGRoot.createSVGPoint();
         GrabPoint = SVGRoot.createSVGPoint();
         BackDrop = SVGDocument.getElementById('BackDrop');
		Init();
      }

      function Grab(evt) {
         var targetElement = evt.target;
         if (BackDrop != targetElement) {
			if(targetElement.id === "Target1" || targetElement.id === "Line1" || targetElement.id === "Line2") {;
		        DragTarget = targetElement;
		        DragTarget.parentNode.appendChild( DragTarget );
		        DragTarget.setAttribute('pointer-events', 'none');
		        var transMatrix = DragTarget.getCTM();
		        GrabPoint.x = TrueCoords.x - Number(transMatrix.e);
		        GrabPoint.y = TrueCoords.y - Number(transMatrix.f);
			}
         }
      };

      function Drag(evt) {
         GetTrueCoords(evt);
         if (DragTarget) {
            var newX = TrueCoords.x - GrabPoint.x;
            var newY = TrueCoords.y - GrabPoint.y;
            DragTarget.setAttribute('transform', 'translate(' + newX + ',' + newY + ')');
         }
      };


      function Drop(evt) {
         if (DragTarget) {
            var targetElement = evt.target;
            DragTarget.setAttribute('pointer-events', 'all');
            DragTarget = null;
         }
      };


      function GetTrueCoords(evt) {
         var newScale = SVGRoot.currentScale;
         var translation = SVGRoot.currentTranslate;
         TrueCoords.x = (evt.clientX - translation.x)/newScale;
         TrueCoords.y = (evt.clientY - translation.y)/newScale;
      };

]]></script>

</svg>
